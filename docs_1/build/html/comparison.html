

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ensemble_comparison &mdash; IDPET 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=2389946f"></script>
      <script src="_static/doctools.js?v=888ff710"></script>
      <script src="_static/sphinx_highlight.js?v=4825356b"></script>
      <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Package Overview" href="modules.html" />
    <link rel="prev" title="visualization" href="visualization.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            IDPET
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="demo.html">Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="ensemble_analysis.html">ensemble_analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="ensemble.html">ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">visualization</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">ensemble_comparison</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#idpet.comparison.all_vs_all_comparison"><code class="docutils literal notranslate"><span class="pre">all_vs_all_comparison()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#idpet.comparison.calc_freqs"><code class="docutils literal notranslate"><span class="pre">calc_freqs()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#idpet.comparison.calc_jsd"><code class="docutils literal notranslate"><span class="pre">calc_jsd()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#idpet.comparison.calc_kld_for_jsd"><code class="docutils literal notranslate"><span class="pre">calc_kld_for_jsd()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#idpet.comparison.check_feature_matrices"><code class="docutils literal notranslate"><span class="pre">check_feature_matrices()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#idpet.comparison.confidence_interval"><code class="docutils literal notranslate"><span class="pre">confidence_interval()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#idpet.comparison.get_adaJSD_matrix"><code class="docutils literal notranslate"><span class="pre">get_adaJSD_matrix()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#idpet.comparison.get_ataJSD_profile"><code class="docutils literal notranslate"><span class="pre">get_ataJSD_profile()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#idpet.comparison.get_num_comparison_bins"><code class="docutils literal notranslate"><span class="pre">get_num_comparison_bins()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#idpet.comparison.get_ramaJSD_profile"><code class="docutils literal notranslate"><span class="pre">get_ramaJSD_profile()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#idpet.comparison.percentile_func"><code class="docutils literal notranslate"><span class="pre">percentile_func()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#idpet.comparison.process_all_vs_all_output"><code class="docutils literal notranslate"><span class="pre">process_all_vs_all_output()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#idpet.comparison.score_adaJSD"><code class="docutils literal notranslate"><span class="pre">score_adaJSD()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#idpet.comparison.score_ataJSD"><code class="docutils literal notranslate"><span class="pre">score_ataJSD()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#idpet.comparison.score_avg_2d_angle_jsd"><code class="docutils literal notranslate"><span class="pre">score_avg_2d_angle_jsd()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#idpet.comparison.score_avg_jsd"><code class="docutils literal notranslate"><span class="pre">score_avg_jsd()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#idpet.comparison.score_histogram_jsd"><code class="docutils literal notranslate"><span class="pre">score_histogram_jsd()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#idpet.comparison.score_ramaJSD"><code class="docutils literal notranslate"><span class="pre">score_ramaJSD()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#idpet.comparison.sqrt_rule"><code class="docutils literal notranslate"><span class="pre">sqrt_rule()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#idpet.comparison.sturges_rule"><code class="docutils literal notranslate"><span class="pre">sturges_rule()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Package Overview</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">IDPET</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">ensemble_comparison</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/comparison.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-idpet.comparison">
<span id="ensemble-comparison"></span><h1>ensemble_comparison<a class="headerlink" href="#module-idpet.comparison" title="Permalink to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="idpet.comparison.all_vs_all_comparison">
<span class="sig-prename descclassname"><span class="pre">idpet.comparison.</span></span><span class="sig-name descname"><span class="pre">all_vs_all_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ensembles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">featurization_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_replace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/idpet/comparison.html#all_vs_all_comparison"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#idpet.comparison.all_vs_all_comparison" title="Permalink to this definition"></a></dt>
<dd><p>Compare all pair of ensembles using divergence scores.
Implemented scores are approximate average Jensen–Shannon divergence
(JSD) over several kinds of molecular features. The lower these scores
are, the higher the similarity between the probability distribution of
the features of the ensembles. JSD scores here range from a minimum of 0
to a maximum of log(2) ~= 0.6931.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></span></p>
</dd>
</dl>
<section id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>ensembles: List[Ensemble]</dt><dd><p>Ensemble objectes to analyze.</p>
</dd>
<dt>score: str</dt><dd><p>Type of score used to compare ensembles. Choices: <cite>adaJSD</cite> (carbon
Alfa Distance Average JSD), <cite>ramaJSD</cite> (RAMAchandran average JSD) and
<cite>ataJSD</cite> (Alpha Torsion Average JSD). <cite>adaJSD</cite> scores the average
JSD over all Ca-Ca distance distributions of residue pairs with
sequence separation &gt; 1. <cite>ramaJSD</cite> scores the average JSD over the
phi-psi angle distributions of all residues. <cite>ataJSD</cite> scores the
average JSD over all alpha torsion angles, which are the angles
formed by four consecutive Ca atoms in a protein.</p>
</dd>
<dt>featurization_params: dict, optional</dt><dd><p>Optional dictionary to customize the featurization process for the
above features.</p>
</dd>
<dt>bootstrap_iters: int, optional</dt><dd><p>Number of bootstrap iterations. By default its value is None. In
this case, IDPET will directly compare each pair of ensemble $i$ and
$j$ by using all of their conformers and perform the comparison only
once. On the other hand, if providing an integer value to this
argument, each pair of ensembles <em>i</em> and <em>j</em> will be compared
<cite>bootstrap_iters</cite> times by randomly selecting (bootstrapping)
conformations from them. Additionally, each ensemble will be
auto-compared with itself by subsampling conformers via
bootstrapping. Then IDPET will perform a statistical test to
establish if the inter-ensemble (<em>i</em> != <em>j</em>) scores are significantly
different from the intra-ensemble (<em>i</em> == <em>j</em>) scores. The tests work
as follows: for each ensemble pair <em>i</em> != <em>j</em> IDPET will get their
inter-ensemble comparison scores obtained in bootstrapping. Then, it
will get the bootstrapping scores from auto-comparisons of ensemble
<em>i</em> and <em>j</em> and the scores with the higher mean here are selected as
reference intra-ensemble scores. Finally, the inter-ensemble and
intra-ensemble scores are compared via a one-sided Mann-Whitney U
test with the alternative hypothesis being: inter-ensemble scores
are stochastically greater than intra-ensemble scores. The p-values
obtained in these tests will additionally be returned. For small
protein structural ensembles (less than 500 conformations) most
comparison scores in IDPET are not robust estimators of
divergence/distance. Bootstrapping helps estimate how ensemble size affects the robustness of the comparisons. Use values &gt;= 50 when comparing small ensembles, with fewer than 100 conformations. For ensembles with more than 100 conformations, 10 iterations are typically sufficient to distinguish the distributions of auto- and intra-comparison scores. For large ensembles, with more than 1,000 conformations, bootstrapping can generally be omitted without loss of accuracy.</p>
</dd>
<dt>bootstrap_frac: float, optional</dt><dd><p>Fraction of the total conformations to sample when bootstrapping.
Default value is 1.0, which results in bootstrap samples with the
same number of conformations of the original ensemble.</p>
</dd>
<dt>bootstrap_replace: bool, optional</dt><dd><p>If <cite>True</cite>, bootstrap will sample with replacement. Default is <cite>True</cite>.</p>
</dd>
<dt>bins: Union[int, str], optional</dt><dd><p>Number of bins or bin assignment rule for JSD comparisons. See the
documentation of <cite>dpet.comparison.get_num_comparison_bins</cite> for
more information.
<em>for the bins=”auto” argument</em>: In IDPET, JSD-based scores are computed by
discretizing data into histograms. The number of bins can influence the results,
so users can either set this parameter manually or rely on the default bins=”auto” option.
With this setting, IDPET automatically determines the number of bins using the square-root
rule (<a class="reference external" href="https://en.wikipedia.org/wiki/Histogram#Square-root_choice">https://en.wikipedia.org/wiki/Histogram#Square-root_choice</a>), based on the smallest ensemble
size. If the smallest ensemble contains more than 2,500 conformers, the number of bins is capped
at 50. A bin count greater than 10 generally provides sufficient resolution to discriminate
interatomic distance or torsion angle distributions in JSD-based analyses of IDPs.
Increasing the number of bins over 10 can improve resolution and discriminative power but also 
requires larger ensemble sizes to avoid sparse histograms. For most protein ensembles, 
values above 50 rarely improves the resolution of the analysis, therefore the maximum bin number
of the “auto” option is capped to this value.</p>
</dd>
<dt>random_seed: int, optional</dt><dd><p>Random seed used when performing bootstrapping.</p>
</dd>
<dt>verbose: bool, optional</dt><dd><p>If <cite>True</cite>, some information about the comparisons will be printed to
stdout.</p>
</dd>
</dl>
</section>
<section id="returns">
<h2>Returns<a class="headerlink" href="#returns" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>results: dict</dt><dd><dl class="simple">
<dt>A dictionary containing the following key-value pairs:</dt><dd><dl class="simple">
<dt><cite>scores</cite>: a (M, M, B) NumPy array storing the comparison</dt><dd><p>scores, where M is the number of ensembles being
compared and B is the number of bootstrap iterations (B
will be 1 if bootstrapping was not performed).</p>
</dd>
<dt><cite>p_values</cite>: a (M, M) NumPy array storing the p-values</dt><dd><p>obtained in the statistical test performed when using
a bootstrapping strategy (see the <cite>bootstrap_iters</cite>)
method. Returned only when performing a bootstrapping
strategy.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="idpet.comparison.calc_freqs">
<span class="sig-prename descclassname"><span class="pre">idpet.comparison.</span></span><span class="sig-name descname"><span class="pre">calc_freqs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/idpet/comparison.html#calc_freqs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#idpet.comparison.calc_freqs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="idpet.comparison.calc_jsd">
<span class="sig-prename descclassname"><span class="pre">idpet.comparison.</span></span><span class="sig-name descname"><span class="pre">calc_jsd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_h</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/idpet/comparison.html#calc_jsd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#idpet.comparison.calc_jsd" title="Permalink to this definition"></a></dt>
<dd><p>Calculates JSD between distribution p and q.
p_h: histogram frequencies for sample p.
q_h: histogram frequencies for sample q.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="idpet.comparison.calc_kld_for_jsd">
<span class="sig-prename descclassname"><span class="pre">idpet.comparison.</span></span><span class="sig-name descname"><span class="pre">calc_kld_for_jsd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_h</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/idpet/comparison.html#calc_kld_for_jsd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#idpet.comparison.calc_kld_for_jsd" title="Permalink to this definition"></a></dt>
<dd><p>Calculates KLD between distribution x and m.
x_h: histogram frequencies for sample p or q.
m_h: histogram frequencies for m = 0.5*(p+q).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="idpet.comparison.check_feature_matrices">
<span class="sig-prename descclassname"><span class="pre">idpet.comparison.</span></span><span class="sig-name descname"><span class="pre">check_feature_matrices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/idpet/comparison.html#check_feature_matrices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#idpet.comparison.check_feature_matrices" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="idpet.comparison.confidence_interval">
<span class="sig-prename descclassname"><span class="pre">idpet.comparison.</span></span><span class="sig-name descname"><span class="pre">confidence_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta_boot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_hat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'percentile'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/idpet/comparison.html#confidence_interval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#idpet.comparison.confidence_interval" title="Permalink to this definition"></a></dt>
<dd><p>Returns bootstrap confidence intervals.
Adapted from: <a class="reference external" href="https://github.com/scipy/scipy/blob/v1.14.0/scipy/stats/_resampling.py">https://github.com/scipy/scipy/blob/v1.14.0/scipy/stats/_resampling.py</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="idpet.comparison.get_adaJSD_matrix">
<span class="sig-prename descclassname"><span class="pre">idpet.comparison.</span></span><span class="sig-name descname"><span class="pre">get_adaJSD_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ens_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ens_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">featurization_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/idpet/comparison.html#get_adaJSD_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#idpet.comparison.get_adaJSD_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Utility function to calculate the adaJSD score between two ensembles and
return a matrix with JSD scores for each pair of Ca-Ca distances.</p>
<section id="id1">
<h2>Parameters<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>ens_1, ens_2: Union[Ensemble, mdtraj.Trajectory]</dt><dd><p>Two Ensemble objects storing the ensemble data to compare.</p>
</dd>
<dt>return_bins<span class="classifier">bool, optional</span></dt><dd><p>If True, also return the histogram bin edges used in the comparison.</p>
</dd>
<dt><a href="#id2"><span class="problematic" id="id3">**</span></a>remaining</dt><dd><p>Additional arguments passed to <cite>dpet.comparison.score_adaJSD</cite>.</p>
</dd>
</dl>
</section>
<section id="output">
<h2>Output<a class="headerlink" href="#output" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>score<span class="classifier">float</span></dt><dd><p>The overall adaJSD score between the two ensembles.</p>
</dd>
<dt>jsd_matrix<span class="classifier">np.ndarray of shape (N, N)</span></dt><dd><p>Matrix containing JSD scores for each Ca-Ca distance pair, where N is
the number of residues.</p>
</dd>
<dt>bin_edges<span class="classifier">np.ndarray, optional</span></dt><dd><p>Returned only if <cite>return_bins=True</cite>. The bin edges used in histogram comparisons.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="idpet.comparison.get_ataJSD_profile">
<span class="sig-prename descclassname"><span class="pre">idpet.comparison.</span></span><span class="sig-name descname"><span class="pre">get_ataJSD_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ens_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ens_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/idpet/comparison.html#get_ataJSD_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#idpet.comparison.get_ataJSD_profile" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Utility function to calculate the ataJSD score between two ensembles and
return a profile with JSD scores for each alpha angle in the proteins.</p>
<dl class="simple">
<dt>ens_1, ens_2: Union[Ensemble, mdtraj.Trajectory]</dt><dd><p>Two Ensemble objects storing the ensemble data to compare.</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>return_bins<span class="classifier">bool, optional</span></dt><dd><blockquote>
<div><p>If True, also return the histogram bin edges used in the comparison.</p>
</div></blockquote>
<dl class="simple">
<dt><a href="#id4"><span class="problematic" id="id5">**</span></a>remaining</dt><dd><p>Additional arguments passed to <cite>dpet.comparison.score_ataJSD</cite>.</p>
</dd>
</dl>
<dl class="simple">
<dt>score<span class="classifier">float</span></dt><dd><p>The overall ataJSD score between the two ensembles.</p>
</dd>
<dt>jsd_profile<span class="classifier">np.ndarray of shape (N - 3,)</span></dt><dd><p>JSD scores for individual α backbone angles, where N is the number
of residues in the protein.</p>
</dd>
<dt>bin_edges<span class="classifier">np.ndarray, optional</span></dt><dd><p>Returned only if <cite>return_bins=True</cite>. The bin edges used in histogram
comparisons.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="idpet.comparison.get_num_comparison_bins">
<span class="sig-prename descclassname"><span class="pre">idpet.comparison.</span></span><span class="sig-name descname"><span class="pre">get_num_comparison_bins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/idpet/comparison.html#get_num_comparison_bins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#idpet.comparison.get_num_comparison_bins" title="Permalink to this definition"></a></dt>
<dd><p>Get the number of bins to be used in comparison between two ensembles using
an histogram-based score (such as a JSD approximation).</p>
<section id="id6">
<h2>Parameters<a class="headerlink" href="#id6" title="Permalink to this heading"></a></h2>
<dl>
<dt>bins: Union[str, int]</dt><dd><p>Determines the number of bins to be used. When providing an <cite>int</cite>, the
same value will simply be returned. When providing a string, the following
rules to determine bin value will be applied:
<cite>auto</cite>: applies <cite>sqrt</cite> if the size of the smallest ensemble is &lt;</p>
<blockquote>
<div><p><cite>dpet.comparison.min_samples_auto_hist</cite>. If it &gt;= than this
value, returns <cite>dpet.comparison.num_default_bins</cite>.</p>
</div></blockquote>
<dl class="simple">
<dt><cite>sqrt</cite>: applies the square root rule for determining bin number using</dt><dd><p>the size of the smallest ensemble (<a class="reference external" href="https://en.wikipedia.org/wiki/Histogram#Square-root_choice">https://en.wikipedia.org/wiki/Histogram#Square-root_choice</a>).</p>
</dd>
<dt><cite>sturges</cite>: applies Sturge’s formula for determining bin number using</dt><dd><p>the size of the smallest ensemble (<a class="reference external" href="https://en.wikipedia.org/wiki/Histogram#Sturges's_formula">https://en.wikipedia.org/wiki/Histogram#Sturges’s_formula</a>).</p>
</dd>
</dl>
</dd>
<dt>x: List[np.ndarray], optional</dt><dd><p>List of M feature matrices (one for each ensembles) of shape (N_i, <a href="#id7"><span class="problematic" id="id8">*</span></a>).
N_i values are the number of structures in each ensemble. The minimum
N_i will be used to apply bin assignment rule when the <cite>bins</cite> argument
is a string.</p>
</dd>
</dl>
</section>
<section id="id9">
<h2>Returns<a class="headerlink" href="#id9" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>num_bins: int</dt><dd><p>Number of bins.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="idpet.comparison.get_ramaJSD_profile">
<span class="sig-prename descclassname"><span class="pre">idpet.comparison.</span></span><span class="sig-name descname"><span class="pre">get_ramaJSD_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ens_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ens_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/idpet/comparison.html#get_ramaJSD_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#idpet.comparison.get_ramaJSD_profile" title="Permalink to this definition"></a></dt>
<dd><p>Utility function to calculate the ramaJSD score between two ensembles and
return a profile with JSD scores for the Ramachandran plots of pair of
corresponding residue in the proteins.</p>
<section id="id10">
<h2>Parameters<a class="headerlink" href="#id10" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>ens_1, ens_2: Union[Ensemble, mdtraj.Trajectory]</dt><dd><p>Two Ensemble objects storing the ensemble data to compare.</p>
</dd>
<dt>return_bins<span class="classifier">bool, optional</span></dt><dd><p>If True, also return the histogram bin edges used in the comparison.</p>
</dd>
<dt><a href="#id11"><span class="problematic" id="id12">**</span></a>remaining</dt><dd><p>Additional arguments passed to <cite>dpet.comparison.score_ramaJSD</cite>.</p>
</dd>
</dl>
</section>
<section id="id13">
<h2>Returns<a class="headerlink" href="#id13" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>score<span class="classifier">float</span></dt><dd><p>The overall ramaJSD score between the two ensembles.</p>
</dd>
<dt>jsd_profile<span class="classifier">np.ndarray of shape (N - 2,)</span></dt><dd><p>JSD scores for the Ramachandran distribution of each residue,
where N is the number of residues in the protein.</p>
</dd>
<dt>bin_edges<span class="classifier">np.ndarray, optional</span></dt><dd><p>Returned only if <cite>return_bins=True</cite>. The bin edges used in histogram
comparisons.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="idpet.comparison.percentile_func">
<span class="sig-prename descclassname"><span class="pre">idpet.comparison.</span></span><span class="sig-name descname"><span class="pre">percentile_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/idpet/comparison.html#percentile_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#idpet.comparison.percentile_func" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="idpet.comparison.process_all_vs_all_output">
<span class="sig-prename descclassname"><span class="pre">idpet.comparison.</span></span><span class="sig-name descname"><span class="pre">process_all_vs_all_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">comparison_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/idpet/comparison.html#process_all_vs_all_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#idpet.comparison.process_all_vs_all_output" title="Permalink to this definition"></a></dt>
<dd><p>Takes as input a dictionary produced as output of the <cite>all_vs_all_comparison</cite>
function. If a bootstrap analysis was performed in <cite>all_vs_all_comparison</cite>,
this function will assign bootstrap confidence intervals.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="idpet.comparison.score_adaJSD">
<span class="sig-prename descclassname"><span class="pre">idpet.comparison.</span></span><span class="sig-name descname"><span class="pre">score_adaJSD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ens_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ens_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">featurization_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/idpet/comparison.html#score_adaJSD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#idpet.comparison.score_adaJSD" title="Permalink to this definition"></a></dt>
<dd><p>Utility function to calculate the adaJSD (carbon Alfa Distance Average JSD)
score between two ensembles. The score evaluates the divergence between
distributions of Ca-Ca distances of the ensembles.</p>
<section id="id14">
<h2>Parameters<a class="headerlink" href="#id14" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>ens_1, ens_2: Union[Ensemble, mdtraj.Trajectory],</dt><dd><p>Two Ensemble or mdtraj.Trajectory objects storing the ensemble data to
compare.</p>
</dd>
<dt>bins: Union[str, int], optional</dt><dd><p>Determines the number of bins to be used when constructing histograms.
See <cite>idpet.comparison.get_num_comparison_bins</cite> for more information.
See also <a class="reference internal" href="idpet.html#idpet.comparison.all_vs_all_comparison" title="idpet.comparison.all_vs_all_comparison"><code class="xref py py-func docutils literal notranslate"><span class="pre">idpet.comparison.all_vs_all_comparison()</span></code></a>.</p>
</dd>
<dt>return_bins: bool, optional</dt><dd><p>If <cite>True</cite>, returns the number of bins used in the calculation.</p>
</dd>
<dt>return_scores: bool, optional</dt><dd><p>If <cite>True</cite>, returns the a tuple with with (avg_score, all_scores), where
all_scores is an array with all the F scores (one for each feature) used
to compute the average score.</p>
</dd>
<dt>featurization_params: dict, optional</dt><dd><p>Optional dictionary to customize the featurization process to calculate
Ca-Ca distances. See the <cite>Ensemble.get_features</cite> function for more
information.</p>
</dd>
</dl>
</section>
<section id="id15">
<h2>Returns<a class="headerlink" href="#id15" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>avg_score<span class="classifier">float</span></dt><dd><p>The average JSD score across the F features.</p>
</dd>
<dt>If <cite>return_scores=True</cite>:</dt><dd><dl class="simple">
<dt>(avg_score, all_scores)<span class="classifier">Tuple[float, np.ndarray]</span></dt><dd><p>The average score and an array of JSD scores of shape (F,).</p>
</dd>
</dl>
</dd>
<dt>If <cite>return_bins=True</cite>:</dt><dd><dl class="simple">
<dt>(avg_score, num_bins)<span class="classifier">Tuple[float, int]</span></dt><dd><p>The average score and the number of bins used.</p>
</dd>
</dl>
</dd>
<dt>If both <cite>return_scores</cite> and <cite>return_bins</cite> are True:</dt><dd><dl class="simple">
<dt>((avg_score, all_scores), num_bins)<span class="classifier">Tuple[Tuple[float, np.ndarray], int]</span></dt><dd><p>The average score, array of per-feature scores, and number of bins used.</p>
</dd>
</dl>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="idpet.comparison.score_ataJSD">
<span class="sig-prename descclassname"><span class="pre">idpet.comparison.</span></span><span class="sig-name descname"><span class="pre">score_ataJSD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ens_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ens_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/idpet/comparison.html#score_ataJSD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#idpet.comparison.score_ataJSD" title="Permalink to this definition"></a></dt>
<dd><p>Utility function to calculate the ataJSD (Alpha Torsion Average JSD) score
between two ensembles. The score evaluates the divergence between
distributions of alpha torsion angles (the angles formed by four consecutive
Ca atoms in a protein) of the ensembles.</p>
<section id="id16">
<h2>Parameters<a class="headerlink" href="#id16" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>ens_1, ens_2: Union[Ensemble, mdtraj.Trajectory]</dt><dd><p>Two Ensemble objects storing the ensemble data to compare.</p>
</dd>
</dl>
<p>bins: Union[str, int], optional
See <a class="reference internal" href="idpet.html#idpet.comparison.all_vs_all_comparison" title="idpet.comparison.all_vs_all_comparison"><code class="xref py py-func docutils literal notranslate"><span class="pre">idpet.comparison.all_vs_all_comparison()</span></code></a>.</p>
</section>
<section id="id17">
<h2>Returns<a class="headerlink" href="#id17" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>avg_score<span class="classifier">float</span></dt><dd><p>The average JSD score across the F features.</p>
</dd>
<dt>If <cite>return_scores=True</cite>:</dt><dd><dl class="simple">
<dt>(avg_score, all_scores)<span class="classifier">Tuple[float, np.ndarray]</span></dt><dd><p>The average score and an array of JSD scores of shape (F,).</p>
</dd>
</dl>
</dd>
<dt>If <cite>return_bins=True</cite>:</dt><dd><dl class="simple">
<dt>(avg_score, num_bins)<span class="classifier">Tuple[float, int]</span></dt><dd><p>The average score and the number of bins used.</p>
</dd>
</dl>
</dd>
<dt>If both <cite>return_scores</cite> and <cite>return_bins</cite> are True:</dt><dd><dl class="simple">
<dt>((avg_score, all_scores), num_bins)<span class="classifier">Tuple[Tuple[float, np.ndarray], int]</span></dt><dd><p>The average score, array of per-feature scores, and number of bins used.</p>
</dd>
</dl>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="idpet.comparison.score_avg_2d_angle_jsd">
<span class="sig-prename descclassname"><span class="pre">idpet.comparison.</span></span><span class="sig-name descname"><span class="pre">score_avg_2d_angle_jsd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">array_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/idpet/comparison.html#score_avg_2d_angle_jsd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#idpet.comparison.score_avg_2d_angle_jsd" title="Permalink to this definition"></a></dt>
<dd><p>Takes as input two (<a href="#id18"><span class="problematic" id="id19">*</span></a>, F, 2) bidimensional feature matrices and computes an
average JSD score over all F bidimensional features by discretizing them
in 2d histograms. The features in this functions are supposed to be angles
whose values range from -math.pi to math.pi. For example, int the
<cite>score_ramaJSD</cite> function the F features represent the phi-psi values of F
residues in a protein of length L=F+2 (first and last residues don’t have
both phi and psi values).</p>
<section id="id20">
<h2>Parameters<a class="headerlink" href="#id20" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>p_data, q_data: np.ndarray</dt><dd><p>NumPy arrays of shape (<a href="#id21"><span class="problematic" id="id22">*</span></a>, F, 2) containing samples from F bi-dimensional
distributions to be compared.</p>
</dd>
<dt>bins: Union[int, str], optional</dt><dd><p>Determines the number of bins to be used when constructing histograms.
See <cite>dpet.comparison.get_num_comparison_bins</cite> for more information. The
range spanned by the bins will be -math.pi to math.pi. Note that the
effective number of bins used in the functio will be the square of
the number returned by <cite>dpet.comparison.get_num_comparison_bins</cite>, since
we are building a 2d histogram.</p>
</dd>
<dt>return_bins: bool, optional</dt><dd><p>If <cite>True</cite>, returns the square root of the effective number of bins used
in the calculation.</p>
</dd>
</dl>
</section>
<section id="id23">
<h2>Returns<a class="headerlink" href="#id23" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>results: Union[float, Tuple[float, np.ndarray]]</dt><dd><p>If <cite>return_bins</cite> is <cite>False</cite>, only returns a float value for the JSD
score. The score will range from 0 (no common support) to log(2)
(same distribution). If <cite>return_bins</cite> is <cite>True</cite>, returns a tuple with
the JSD score and the number of bins. If <cite>return_scores</cite> is <cite>True</cite> it
will also return the F scores used to compute the average JSD score.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="idpet.comparison.score_avg_jsd">
<span class="sig-prename descclassname"><span class="pre">idpet.comparison.</span></span><span class="sig-name descname"><span class="pre">score_avg_jsd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/idpet/comparison.html#score_avg_jsd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#idpet.comparison.score_avg_jsd" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="idpet.comparison.score_histogram_jsd">
<span class="sig-prename descclassname"><span class="pre">idpet.comparison.</span></span><span class="sig-name descname"><span class="pre">score_histogram_jsd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/idpet/comparison.html#score_histogram_jsd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#idpet.comparison.score_histogram_jsd" title="Permalink to this definition"></a></dt>
<dd><p>Scores an approximation of Jensen-Shannon divergence by discretizing in a
histogram the values two 1d samples provided as input.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]]</span></p>
</dd>
</dl>
<section id="id24">
<h2>Parameters<a class="headerlink" href="#id24" title="Permalink to this heading"></a></h2>
<dl>
<dt>p_data, q_data: np.ndarray</dt><dd><p>NumPy arrays of shape (<a href="#id25"><span class="problematic" id="id26">*</span></a>, ) containing samples from two mono-dimensional
distribution to be compared.</p>
</dd>
<dt>limits: Union[str, Tuple[int]]</dt><dd><p>Define the method to calculate the minimum and maximum values of the
range spanned by the bins. Accepted values are:</p>
<blockquote>
<div><dl class="simple">
<dt>“m”: will use the minimum and maximum values observed by</dt><dd><p>concatenating samples in <cite>p_data</cite> and <cite>q_data</cite>.</p>
</dd>
<dt>“p”: will use the minimum and maximum values observed by</dt><dd><p>concatenating samples in <cite>p_data</cite>. If <cite>q_data</cite> contains values
outside that range, new bins of the same size will be added to
cover all values of q. Currently, this is not used in any IDPET
functionality. Note that the <cite>bins</cite> argument will determine
only the bins originally spanned by <cite>p_data</cite>.</p>
</dd>
<dt>“a”: limits for scoring angular features. Will use a</dt><dd><p>(-math.pi, math.pi) range for scoring such features.</p>
</dd>
<dt>(float, float): provide a custom range. Currently, not used in any</dt><dd><p>IDPET functionality.</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>bins: Union[int, str], optional</dt><dd><p>Determines the number of bins to be used when constructing histograms.
See <cite>dpet.comparison.get_num_comparison_bins</cite> for more information. The
range spanned by the bins will be define by the <cite>limits</cite> argument.</p>
</dd>
<dt>return_bins: bool, optional</dt><dd><p>If <cite>True</cite>, returns the bins used in the calculation.</p>
</dd>
</dl>
</section>
<section id="id27">
<h2>Returns<a class="headerlink" href="#id27" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>results: Union[float, Tuple[float, np.ndarray]]</dt><dd><p>If <cite>return_bins</cite> is <cite>False</cite>, only returns a float value for the JSD
score. The score will range from 0 (no common support) to log(2)
(same distribution). If <cite>return_bins</cite> is <cite>True</cite>, returns a tuple with
the JSD score and the number of bins.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="idpet.comparison.score_ramaJSD">
<span class="sig-prename descclassname"><span class="pre">idpet.comparison.</span></span><span class="sig-name descname"><span class="pre">score_ramaJSD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ens_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ens_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/idpet/comparison.html#score_ramaJSD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#idpet.comparison.score_ramaJSD" title="Permalink to this definition"></a></dt>
<dd><p>Utility unction to calculate the ramaJSD (Ramachandran plot average JSD)
score between two ensembles. The score evaluates the divergence between
distributions of phi-psi torsion angles of every residue in the ensembles.</p>
<section id="id28">
<h2>Parameters<a class="headerlink" href="#id28" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>ens_1, ens_2: Union[Ensemble, mdtraj.Trajectory]</dt><dd><p>Two Ensemble objects storing the ensemble data to compare.</p>
</dd>
</dl>
<p>bins: Union[int, str], optional
See <a class="reference internal" href="idpet.html#idpet.comparison.all_vs_all_comparison" title="idpet.comparison.all_vs_all_comparison"><code class="xref py py-func docutils literal notranslate"><span class="pre">idpet.comparison.all_vs_all_comparison()</span></code></a>.</p>
</section>
<section id="id29">
<h2>Returns<a class="headerlink" href="#id29" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>avg_score<span class="classifier">float</span></dt><dd><p>The average JSD score across the F features.</p>
</dd>
<dt>If <cite>return_scores=True</cite>:</dt><dd><dl class="simple">
<dt>(avg_score, all_scores)<span class="classifier">Tuple[float, np.ndarray]</span></dt><dd><p>The average score and an array of JSD scores of shape (F,).</p>
</dd>
</dl>
</dd>
<dt>If <cite>return_bins=True</cite>:</dt><dd><dl class="simple">
<dt>(avg_score, num_bins)<span class="classifier">Tuple[float, int]</span></dt><dd><p>The average score and the number of bins used.</p>
</dd>
</dl>
</dd>
<dt>If both <cite>return_scores</cite> and <cite>return_bins</cite> are True:</dt><dd><dl class="simple">
<dt>((avg_score, all_scores), num_bins)<span class="classifier">Tuple[Tuple[float, np.ndarray], int]</span></dt><dd><p>The average score, array of per-feature scores, and number of bins used.</p>
</dd>
</dl>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="idpet.comparison.sqrt_rule">
<span class="sig-prename descclassname"><span class="pre">idpet.comparison.</span></span><span class="sig-name descname"><span class="pre">sqrt_rule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/idpet/comparison.html#sqrt_rule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#idpet.comparison.sqrt_rule" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="idpet.comparison.sturges_rule">
<span class="sig-prename descclassname"><span class="pre">idpet.comparison.</span></span><span class="sig-name descname"><span class="pre">sturges_rule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/idpet/comparison.html#sturges_rule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#idpet.comparison.sturges_rule" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="visualization.html" class="btn btn-neutral float-left" title="visualization" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="modules.html" class="btn btn-neutral float-right" title="Package Overview" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Hamidreza Ghafouri, Giacomo Janson, Silvio C.E. Tosatto, Alexander Miguel Monzon.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>