<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Local analysis &mdash; Disordered Protein Ensemble Tools 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=af2ce170"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=4825356b"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Dimensional Reduction Analysis" href="dimensional_reduction.html" />
    <link rel="prev" title="Global analysis" href="Global_analysis.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Disordered Protein Ensemble Tools
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="demo.html">Demo</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Global_analysis.html">Global analysis</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Local analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#contact-map">Contact map</a></li>
<li class="toctree-l3"><a class="reference internal" href="#d-ramachandran-histograms">2D Ramachandran histograms</a></li>
<li class="toctree-l3"><a class="reference internal" href="#alpha-angles-dihedral-distribution">Alpha angles dihedral distribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#relative-dssp-dictionary-of-secondary-structure-of-proteins-content">Relative DSSP (Dictionary of Secondary Structure of Proteins) content</a></li>
<li class="toctree-l3"><a class="reference internal" href="#site-specific-flexibility-parameter">Site-specific flexibility parameter</a></li>
<li class="toctree-l3"><a class="reference internal" href="#site-specific-order-parameter">Site-specific order parameter</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dimensional_reduction.html">Dimensional Reduction Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="comparing_ensambles.html">Comparing Ensambles</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ensemble_analysis.html">ensemble_analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="ensemble.html">ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">visualization</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Disordered Protein Ensemble Tools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="demo.html">Demo</a></li>
      <li class="breadcrumb-item active">Local analysis</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/local_analysis.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="local-analysis">
<h1>Local analysis<a class="headerlink" href="#local-analysis" title="Permalink to this heading"></a></h1>
<p>Local protein analysis is a detailed study of specific regions of a protein to better understand their structure, dynamics, and functionality. This type of analysis is crucial for identifying how individual parts of a protein contribute to its overall behavior and molecular interactions.</p>
<p>In the following package, several functions have been implemented to support this analysis, including the distance map, contact map, and various flexibility and order parameters. These tools are designed to provide in-depth information on the local structure of proteins.</p>
<p>To illustrate the output of the implemented functions, the SH3 protein analysis was chosen as an example. Data for three distinct ensembles were directly downloaded from the Protein Ensemble Database (PED): PED00156, PED00157, and PED00158. These ensembles represent structural states of the N-terminal SH3 domain of the Drk protein (residues 1-59) in its unfolded form, generated using different approaches to initialize pools of random conformations.</p>
<ul class="simple">
<li><p><strong>PED00156</strong>: Conformations generated randomly and optimized through an iterative process.</p></li>
<li><p><strong>PED00157</strong>: Conformations generated using the ENSEMBLE method, which creates a variety of realistic conformations of an unfolded protein.</p></li>
<li><p><strong>PED00158</strong>: A combination of conformations from the RANDOM and ENSEMBLE pools, offering greater conformational diversity.</p></li>
</ul>
<p>The presented graphs compare the different structural and dynamic characteristics of the various ensembles, providing valuable information on the flexibility and order of the SH3 protein in different states.</p>
<section id="contact-map">
<h2>Contact map<a class="headerlink" href="#contact-map" title="Permalink to this heading"></a></h2>
<p>The contact map is a graphical representation of the contact matrix, whose elements represent the likelihood of contact between two residues, with values approaching 1 indicating close proximity and values approaching 0 indicating spatial separation.
The graphs show the contact maps generated from the coordinates of the alpha carbon atoms of the proteins under study, aiming to understand the spatial relationships and local interactions within the protein structure.</p>
<p><em>“norm”: If True, use a log scale range; default is True.</em></p>
<p><em>“min_sep”,”max_sep”: Minimum and Maximum separation distance between atoms to consider, respectively; default is 2 and None, respectively.</em></p>
<p><em>“threshold”: Determines the threshold for calculating the contact frequencies; default is 0.8 nm.</em></p>
<p><em>“dpi”: For changing the quality and dimension of the output figure; default is 96.</em></p>
<p><em>“save”: If True, the plot will be saved as an image file; default is False.</em></p>
<p><em>“cmap_color”: Select a color for the contact map; default is “Blues”.</em></p>
<p><em>“ax”: A list or array of Axes objects to plot on; default is None, which creates new axes.</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">visualization</span><span class="o">.</span><span class="n">contact_prob_maps</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
</pre></div>
</div>
<img alt="images/sh3/local_analysis/probmap.png" class="align-center" src="images/sh3/local_analysis/probmap.png" />
</section>
<section id="d-ramachandran-histograms">
<h2>2D Ramachandran histograms<a class="headerlink" href="#d-ramachandran-histograms" title="Permalink to this heading"></a></h2>
<p>The function generates Ramachandran plots to visualize the distribution of phi (ϕ) and psi (ψ) torsion angles of proteins within the ensembles. To calculate the torsion angles, MDTraj functions are used, and the results are then converted to degrees using <em>np.degrees</em>.
If <em>two_d_hist</em> is set to False, it returns a simple scatter plot for all ensembles in a single plot. If set to True, it returns a 2D histogram for each ensemble, where the angles are grouped into a 2D histogram showing the population density of the conformations.</p>
<p><a href="#id1"><span class="problematic" id="id2">*</span></a>”two_d_hist”: Boolean that determines whether to display a 2D histogram (True) or a scatter plot (False).</p>
<p><a href="#id3"><span class="problematic" id="id4">*</span></a>”linespaces”: Tuple that specifies the range and the number of bins for the 2D histogram.</p>
<p><em>“save”: If True, saves the plot in the data directory; default is False.</em></p>
<p><em>“ax”: The matplotlib Axes object on which to plot; if None, creates a new Axes object.</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">visualization</span><span class="o">.</span><span class="n">ramachandran_plots</span><span class="p">(</span><span class="n">two_d_hist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="images/sh3/local_analysis/rama.png" class="align-center" src="images/sh3/local_analysis/rama.png" />
</section>
<section id="alpha-angles-dihedral-distribution">
<h2>Alpha angles dihedral distribution<a class="headerlink" href="#alpha-angles-dihedral-distribution" title="Permalink to this heading"></a></h2>
<p>Alpha angles are a type of dihedral angle calculated using the backbone atoms of the protein, typically involving the C-alpha (Cα) atoms. So frist of all we remind that a dihedral angle, also known as a torsion angle, is the angle between two planes formed by four sequentially bonded atoms in a molecule and  it provides insight into the 3D conformation of the molecule.
Consequentially the calculation of alpha angles involves computing the dihedral angles formed by consecutive Cα atoms. Frist of all the code identify the indices of all Cα atoms in the protein and create sets of four consecutive Cα atoms. Afterwards, using these sets of atoms, the torsion angles are calculated using the <em>MDTraj</em> function, that takes in input the trajectory and a list of tuples, where each tuple contains the indices of four consecutive Cα atoms. The output is a numpy array that contains the dihedral angles calculated for each set of four consecutive Cα atoms. These dihedral angles represent the alpha angles of the protein and provide crucial insights into its three-dimensional conformation and dynamics.</p>
<p><em>“bins”: Number of bins for the histogram; default is 50.</em></p>
<p><em>“save”: If True, saves the plot in the data directory; default is False.</em></p>
<p><em>“ax”: The matplotlib Axes object on which to plot; if None, creates a new Axes object.</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">visualization</span><span class="o">.</span><span class="n">alpha_angles</span><span class="p">()</span>
</pre></div>
</div>
<img alt="images/sh3/global_analysis/dihedral.png" class="align-center" src="images/sh3/global_analysis/dihedral.png" />
</section>
<section id="relative-dssp-dictionary-of-secondary-structure-of-proteins-content">
<h2>Relative DSSP (Dictionary of Secondary Structure of Proteins) content<a class="headerlink" href="#relative-dssp-dictionary-of-secondary-structure-of-proteins-content" title="Permalink to this heading"></a></h2>
<p>The following function visualizes the relative content of a specific secondary structure (helix, coil, strand) for each residue in various protein ensembles. After checking the compatibility of the analysis, it retrieves the DSSP data of the proteins and creates a plot showing the frequency of the selected structure at each position.</p>
<p><em>“dssp_code”: This parameter specifies the type of secondary structure to analyze, which can be ‘H’ for Helix, ‘C’ for Coil, or ‘E’ for Strand.</em></p>
<p><em>“save”:If True, the plot will be saved in the data directory. Default is False.</em></p>
<p><em>“ax”: The matplotlib Axes object on which to plot; if None, creates a new Axes object.</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">visualization</span><span class="o">.</span><span class="n">relative_dssp_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dssp_code</span> <span class="o">=</span><span class="s1">&#39;H&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="images/sh3/global_analysis/contentH.png" class="align-center" src="images/sh3/global_analysis/contentH.png" />
</section>
<section id="site-specific-flexibility-parameter">
<h2>Site-specific flexibility parameter<a class="headerlink" href="#site-specific-flexibility-parameter" title="Permalink to this heading"></a></h2>
<p>The “Site-specific flexibility parameter” quantifies the local flexibility of a protein chain at a specific residue, it anges from 0 (high flexibility) to 1 (no flexibility).
If all conformers have the same dihedral angles at a residue, the circular variance is equal to one, indicating no flexibility, conversely, for a large ensemble with a uniform distribution of dihedral angles, the circular variance tends to zero.</p>
<p>The site-specific flexibility parameter is defined using the circular variance of the Ramachandran angles :math:` phi_{i}` and <span class="math notranslate nohighlight">\(\psi_{i}\)</span>. The circular variance of <span class="math notranslate nohighlight">\(\phi_{i}\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[R_{\phi_{i}} =(\frac{1}{C} \sum_{c=1}^{C} w_{c} sin \phi_{i,c})^2 + (\frac{1}{C} \sum_{c=1}^{C} w_{c} cos \phi_{i,c})^2\]</div>
<p>An analogous expression applies for <span class="math notranslate nohighlight">\(R_{\psi_{i}}\)</span>. The site-specific flexibility parameter <span class="math notranslate nohighlight">\(f_{i}\)</span> is then defined as:</p>
<div class="math notranslate nohighlight">
\[f_i = 1 - \frac{1}{2} \left( R_{\phi_i} + R_{\psi_i} \right)\]</div>
<p><em>“pointer”: A list of desired residues; vertical dashed lines will be added to point to these residues. Default is None.</em></p>
<p><em>“figsize”: The size of the figure. Default is (15, 5).</em></p>
<p><em>“save”: If True, the plot will be saved as an image file. Default is False.</em></p>
<p><em>“ax”: The matplotlib Axes object on which to plot; if None, a new Axes object will be created. Default is None.</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">visualization</span><span class="o">.</span><span class="n">ss_flexibility_parameter</span><span class="p">(</span><span class="n">pointer</span><span class="o">=</span><span class="p">[])</span>
</pre></div>
</div>
<img alt="images/sh3/local_analysis/ssflex_param.png" class="align-center" src="images/sh3/local_analysis/ssflex_param.png" />
</section>
<section id="site-specific-order-parameter">
<h2>Site-specific order parameter<a class="headerlink" href="#site-specific-order-parameter" title="Permalink to this heading"></a></h2>
<p>The “Site-specific order parameter” is an indicator that evaluates the local order within a protein chain. This parameter measures the orientation correlation between neighboring residues along the protein chain, based on the direction of the Cα-Cα vectors.
The parameter is derived by computing the ensemble mean of the cosine of the angle between these vectors and assessing its variance across conformers.</p>
<p>The mean orientation correlation <span class="math notranslate nohighlight">\(&lt;cos \theta_{ij}&gt;\)</span> is calculated as:</p>
<div class="math notranslate nohighlight">
\[&lt;cos \theta_{ij}&gt; = \frac{1}{C} \sum_{c=1}^{C} w_{c} cos\theta_{ij,c}\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(w_c\)</span> is the weight of conformer <span class="math notranslate nohighlight">\(c\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(C\)</span> is the total number of conformers</p></li>
<li><p><span class="math notranslate nohighlight">\(cos \theta_{ij,c}\)</span> is  the cosine of the angle between vectors <span class="math notranslate nohighlight">\(r_{i,i+1}\)</span> and <span class="math notranslate nohighlight">\(r_{j,j+1}\)</span> for conformer <span class="math notranslate nohighlight">\(c\)</span>.</p></li>
</ul>
<p>The variance <span class="math notranslate nohighlight">\(&lt;\sigma_{ij}^2&gt;\)</span> of  <span class="math notranslate nohighlight">\(&lt;cos \theta_{ij}&gt;\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[\sigma_{ij}^2 = \frac{1}{C} \sum_{c=1}^{C} (w_{c} cos  \theta_{ij,c}-&lt;cos  \theta_{ij}&gt;)^2\]</div>
<p>The site-specific order parameter <span class="math notranslate nohighlight">\(K_{ij}\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[K_{ij} = 1 - \sigma_{ij}^2\]</div>
<p>To characterize the order at residue <span class="math notranslate nohighlight">\(i\)</span>  in relation to the entire chain, the site-specific order parameter <span class="math notranslate nohighlight">\(o_{i}\)</span> is computed by summing <span class="math notranslate nohighlight">\(K_{ij}\)</span> over all residues <span class="math notranslate nohighlight">\(j\)</span> :</p>
<div class="math notranslate nohighlight">
\[o_{i} = \frac{1}{N} \sum_{j=1}^{N} K_{ij}\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> represents the total number of residues in the protein chain.</p>
<p><em>“pointer”: A list of desired residues; vertical dashed lines will be added to point to these residues. Default is None.</em></p>
<p><em>“figsize”: The size of the figure. Default is (15, 5).</em></p>
<p><em>“save”: If True, the plot will be saved as an image file. Default is False.</em></p>
<p><em>“ax”: The matplotlib Axes object on which to plot; if None, a new Axes object will be created. Default is None.</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">visualization</span><span class="o">.</span><span class="n">ss_order_parameter</span><span class="p">(</span><span class="n">pointer</span><span class="o">=</span><span class="p">[])</span>
</pre></div>
</div>
<img alt="images/sh3/local_analysis/ssorder_param.png" class="align-center" src="images/sh3/local_analysis/ssorder_param.png" />
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Global_analysis.html" class="btn btn-neutral float-left" title="Global analysis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dimensional_reduction.html" class="btn btn-neutral float-right" title="Dimensional Reduction Analysis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Hamidreza Ghafouri, Giacomo Janson, Nikola Ivanović.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>