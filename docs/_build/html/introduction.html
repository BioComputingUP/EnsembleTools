<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Introduction to Disordered Protein Ensemble Tools &mdash; Disordered Protein Ensemble Tools 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=af2ce170"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Disordered Protein Ensemble Tools
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="demo.html">Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="ensemble_analysis.html">ensemble_analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="ensemble.html">ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">visualization</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Disordered Protein Ensemble Tools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Introduction to Disordered Protein Ensemble Tools</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/introduction.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="introduction-to-disordered-protein-ensemble-tools">
<span id="intro"></span><h1>Introduction to Disordered Protein Ensemble Tools<a class="headerlink" href="#introduction-to-disordered-protein-ensemble-tools" title="Permalink to this heading"></a></h1>
<p>TODO: Write the introduction</p>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#basic-workflow-example" id="id1">Basic Workflow Example</a></p></li>
<li><p><a class="reference internal" href="#end-to-end-example" id="id2">End-to-End Example</a></p></li>
<li><p><a class="reference internal" href="#plot-example" id="id3">Plot Example</a></p></li>
<li><p><a class="reference internal" href="#coarse-grained-models" id="id4">Coarse-Grained Models</a></p></li>
<li><p><a class="reference internal" href="#ensemble-files-with-multiple-chains" id="id5">Ensemble Files with Multiple Chains</a></p></li>
</ul>
</nav>
<section id="basic-workflow-example">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Basic Workflow Example</a><a class="headerlink" href="#basic-workflow-example" title="Permalink to this heading"></a></h2>
<p>TODO: Perhaps insert a graphical representation of the pipeline steps in order</p>
<p>The first step of the pipeline is to instantiate the EnsembleAnalysis class by providing a list of Ensembles to analyze and the path to the output directory.
Different input types are supported. Ensembles can be loaded from a data file (for example, a PDB file), a trajectory file with an accompanying topology file,
or the ensembles can be downloaded from a database.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ensembles</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Ensemble</span><span class="p">(</span><span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;PED00423e001&#39;</span><span class="p">,</span> <span class="n">data_path</span> <span class="o">=</span> <span class="s1">&#39;path/to/data/file&#39;</span><span class="p">)</span>
    <span class="n">Ensemble</span><span class="p">(</span><span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;PED00424e001&#39;</span><span class="p">,</span> <span class="n">data_path</span> <span class="o">=</span> <span class="s1">&#39;path/to/traj/file&#39;</span><span class="p">,</span> <span class="n">top_path</span> <span class="o">=</span> <span class="s1">&#39;path/to/top/file&#39;</span><span class="p">)</span>
<span class="p">]</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="s1">&#39;path/to/output/directory&#39;</span>

<span class="n">analysis</span> <span class="o">=</span> <span class="n">EnsembleAnalysis</span><span class="p">(</span><span class="n">ensembles</span> <span class="o">=</span> <span class="n">ensembles</span><span class="p">,</span> <span class="n">output_dir</span> <span class="o">=</span> <span class="n">output_dir</span><span class="p">)</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">load_trajectories</span><span class="p">()</span>
</pre></div>
</div>
<p>Optionally, a random number of conformations of given size is sampled from the trajectories for further analysis.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span><span class="o">.</span><span class="n">random_sample_trajectories</span><span class="p">(</span><span class="n">sample_size</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, feature extraction is performed on the ensemble trajectories by selecting one of the supported methods.
In this example, the features are phi and psi angles computed from the trajectories.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span><span class="n">featurization</span><span class="o">=</span><span class="s1">&#39;phi_psi&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, one of several dimensionality reduction methods is performed on the previously extracted features by calling the following function.
In this example, t-SNE dimensionality reduction is performed for perplexities 10, 50 and 100. The data is then clustered using K-means with
the given number of clusters. The best combination of perplexity and number of clusters is determined by computing the silhouette score and the
best results are kept. By setting circular to True, unit vector distance is used as t-SNE metric.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span><span class="o">.</span><span class="n">reduce_features</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;tsne&#39;</span><span class="p">,</span> <span class="n">perplexity_vals</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">circular</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">range_n_clusters</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<p>Once the data transformation pipeline is completed, the Visualization class is instantiated to analyse the results.
In the example below, the figure is saved in the output directory.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">visualization</span> <span class="o">=</span> <span class="n">Visualization</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span>
<span class="n">visualization</span><span class="o">.</span><span class="n">tsne_scatter</span><span class="p">(</span><span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="images/tsnep10_kmeans2_scatter.png" src="images/tsnep10_kmeans2_scatter.png" />
</section>
<section id="end-to-end-example">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">End-to-End Example</a><a class="headerlink" href="#end-to-end-example" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>In the example below, the complete data analysis pipeline is executed with one function call. The pipeline consists of:</dt><dd><ol class="arabic simple">
<li><p>Downloading trajectories from the Atlas database</p></li>
<li><p>Loading trajectories</p></li>
<li><p>Randomly sampling 200 conformations</p></li>
<li><p>Extracting features</p></li>
<li><p>Performing dimensionality reduction on the features</p></li>
</ol>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ensembles</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Ensemble</span><span class="p">(</span><span class="s1">&#39;3a1g_B&#39;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;atlas&#39;</span><span class="p">)</span>
<span class="p">]</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="s1">&#39;path/to/output/directory&#39;</span>

<span class="n">featurization_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;featurization&#39;</span><span class="p">:</span> <span class="s1">&#39;ca_dist&#39;</span><span class="p">}</span>
<span class="n">reduce_dim_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;dimenfix&#39;</span><span class="p">,</span> <span class="s1">&#39;range_n_clusters&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]}</span>

<span class="n">analysis</span> <span class="o">=</span> <span class="n">EnsembleAnalysis</span><span class="p">(</span><span class="n">ensembles</span> <span class="o">=</span> <span class="n">ensembles</span><span class="p">,</span> <span class="n">output_dir</span> <span class="o">=</span> <span class="n">output_dir</span><span class="p">)</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">execute_pipeline</span><span class="p">(</span><span class="n">featurization_params</span> <span class="o">=</span> <span class="n">featurization_params</span><span class="p">,</span> <span class="n">reduce_dim_params</span> <span class="o">=</span> <span class="n">reduce_dim_params</span><span class="p">,</span> <span class="n">subsample_size</span><span class="o">=</span>  <span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
<p>As in the previous example, the transformed ensemble data can be visualised with supported plot functions.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">visualization</span> <span class="o">=</span> <span class="n">Visualization</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span>
<span class="n">visualization</span><span class="o">.</span><span class="n">dimenfix_scatter</span><span class="p">()</span>
</pre></div>
</div>
<img alt="images/dimenfix_scatter.png" src="images/dimenfix_scatter.png" />
</section>
<section id="plot-example">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Plot Example</a><a class="headerlink" href="#plot-example" title="Permalink to this heading"></a></h2>
<p>In this example, we perform analysis on ensembles from PED by displaying several plots on the same figure.
If axes are not passed as a parameter to the plot functions, they will be displayed as separate plots.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the ensemble codes with their respective data paths and topology files</span>
<span class="n">ens_codes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Ensemble</span><span class="p">(</span><span class="s1">&#39;PED00424e001&#39;</span><span class="p">,</span> <span class="n">data_path</span><span class="o">=</span><span class="s1">&#39;path/to/trajectory/file&#39;</span><span class="p">,</span> <span class="n">top_path</span><span class="o">=</span><span class="s1">&#39;path/to/topology/file&#39;</span><span class="p">),</span>
    <span class="n">Ensemble</span><span class="p">(</span><span class="s1">&#39;PED00423e001&#39;</span><span class="p">,</span> <span class="n">data_path</span><span class="o">=</span><span class="s1">&#39;path/to/trajectory/file&#39;</span><span class="p">,</span> <span class="n">top_path</span><span class="o">=</span><span class="s1">&#39;path/to/topology/file&#39;</span><span class="p">)</span>
<span class="p">]</span>

<span class="c1"># Specify the directory where the data is stored</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="s1">&#39;path/to/output/directory&#39;</span>

<span class="c1"># Create an instance of EnsembleAnalysis with the specified ensembles and data directory</span>
<span class="n">analysis</span> <span class="o">=</span> <span class="n">EnsembleAnalysis</span><span class="p">(</span><span class="n">ens_codes</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">)</span>

<span class="c1"># Load the trajectories for the ensembles</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">load_trajectories</span><span class="p">()</span>

<span class="c1"># Create an instance of the Visualization class, passing in the analysis object</span>
<span class="n">vis</span> <span class="o">=</span> <span class="n">Visualization</span><span class="p">(</span><span class="n">analysis</span><span class="o">=</span><span class="n">analysis</span><span class="p">)</span>

<span class="c1"># Create a figure and a 2x2 grid of subplots for visualization</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Plot the end-to-end distances on the first subplot (top-left) using a histogram</span>
<span class="n">vis</span><span class="o">.</span><span class="n">end_to_end_distances</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">violin_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Plot the asphericity on the second subplot (top-right)</span>
<span class="n">vis</span><span class="o">.</span><span class="n">asphericity</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># Plot the average distance maps on the bottom two subplots</span>
<span class="n">vis</span><span class="o">.</span><span class="n">average_distance_maps</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Display the figure with all subplots</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>This code snippet demonstrates how to load trajectories for multiple ensembles and visualize different structural properties on a single figure.</p>
<img alt="Visualization of end-to-end distances, asphericity, and average distance maps" src="images/analysis_visualization_example.png" />
</section>
<section id="coarse-grained-models">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Coarse-Grained Models</a><a class="headerlink" href="#coarse-grained-models" title="Permalink to this heading"></a></h2>
<p>Coarse-Grained models are supported, however they are incompatible with some functionalities of the package.</p>
</section>
<section id="ensemble-files-with-multiple-chains">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Ensemble Files with Multiple Chains</a><a class="headerlink" href="#ensemble-files-with-multiple-chains" title="Permalink to this heading"></a></h2>
<p>When dealing with PDB ensemble files that contain multiple chains, it is necessary to specify which chain to analyze when instantiating an <cite>Ensemble</cite> object.
Example usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the ensemble with a specified chain ID</span>
<span class="n">ensembles</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Ensemble</span><span class="p">(</span><span class="s1">&#39;PED00014e001&#39;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;ped&#39;</span><span class="p">,</span> <span class="n">chain_id</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">),</span>
<span class="p">]</span>

<span class="c1"># Specify the directory where the data is stored</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="s1">&#39;path/to/output/directory&#39;</span>

<span class="c1"># Create an instance of EnsembleAnalysis with the specified ensembles and output directory</span>
<span class="n">analysis</span> <span class="o">=</span> <span class="n">EnsembleAnalysis</span><span class="p">(</span><span class="n">ensembles</span><span class="o">=</span><span class="n">ensembles</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="n">output_dir</span><span class="p">)</span>

<span class="c1"># Load the trajectories for the ensembles</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">load_trajectories</span><span class="p">()</span>
</pre></div>
</div>
<dl class="simple">
<dt>Notes:</dt><dd><ul class="simple">
<li><p>The <cite>chain_id</cite> parameter should be specified as the chain identifier (e.g., ‘A’, ‘B’, ‘C’).</p></li>
<li><p>If multiple chains are present and <cite>chain_id</cite> is not specified, an error will be raised.</p></li>
<li><p>This feature is currently only supported for PDB files.</p></li>
</ul>
</dd>
</dl>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Hamidreza Ghafouri, Giacomo Janson, Nikola Ivanović.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>